{% extends "base.html" %}
{% block results %}
	<h1>Results from load test</h1>
	<hr />
	<div id="results-container">
		<h2 id="first-heading-results">Errors returned</h2>
		<h3 id='total-errors'></h2>
		<div id="response-times-container" class="chart-container"></div>
		<h2 id="first-heading-results">Status codes</h2>
		<div id="response-times-container" class="chart-container"></div>
	</div>
	<script>
		$(document).ready(function(){
			var results = {"errors":"39,2,7,0,8,0,10,0,12","connection-rate":"1.1","response-time":"50.6","status-codes":"0,1,0,0,0","transfer-time":"811.4","replies":"1","test-duration":"0.912","requests":"1","request-rate":"1.1"};
			//Parsins error results and creating array of key value pairs.
			var errors = results.errors.split(',');
			var error_codes = ['Client timeout', 'Socket timeout', 'Connection refused', 'Connection reset', 'File descriptor unavailable', 'Address unavailable', 'ftab full', 'Other'];
			var error_results = [];
			$.each(error_codes, function (index, code){
				error_results.push([code, parseInt(errors[index+1])]);
			})
			$('#total-errors').text('Total errors: ' + errors[0]);
			
			$(function () {
				    $('#response-times-container').highcharts({
				        chart: {
				            type: 'column'
				        },
				        title: {
				            text: ''
				        },
				        xAxis: {
				            type: 'category',
				            labels: {
				                rotation: -45,
				                style: {
				                    fontSize: '12px',
				                    fontFamily: 'Arial, sans-serif'
				                }
				            }
				        },
				        yAxis: {
				            min: 0,
				            title: {
				                text: 'Number of instances'
				            }
				        },
				        legend: {
				            enabled: false
				        },
				        tooltip: {
				            pointFormat: 'Number of instances <b>{point.y}</b>'
				        },
				        series: [{
				            name: 'Types',
				            data: error_results
				        }]
				    });
			});
			/**
			 * Sand-Signika theme for Highcharts JS
			 * @author Torstein Honsi
			 */

			// Load the fonts
			Highcharts.createElement('link', {
			   href: '//fonts.googleapis.com/css?family=Signika:400,700',
			   rel: 'stylesheet',
			   type: 'text/css'
			}, null, document.getElementsByTagName('head')[0]);

			// Add the background image to the container
			Highcharts.wrap(Highcharts.Chart.prototype, 'getContainer', function (proceed) {
			   proceed.call(this);
			});


			Highcharts.theme = {
			   colors: ["#f45b5b", "#8085e9", "#8d4654", "#7798BF", "#aaeeee", "#ff0066", "#eeaaee",
			      "#55BF3B", "#DF5353", "#7798BF", "#aaeeee"],
			   chart: {
			      backgroundColor: null,
			      style: {
			         fontFamily: "Signika, serif"
			      }
			   },
			   title: {
			      style: {
			         color: 'black',
			         fontSize: '16px',
			         fontWeight: 'bold'
			      }
			   },
			   subtitle: {
			      style: {
			         color: 'black'
			      }
			   },
			   tooltip: {
			      borderWidth: 0
			   },
			   legend: {
			      itemStyle: {
			         fontWeight: 'bold',
			         fontSize: '13px'
			      }
			   },
			   xAxis: {
			      labels: {
			         style: {
			            color: '#6e6e70'
			         }
			      }
			   },
			   yAxis: {
			      labels: {
			         style: {
			            color: '#6e6e70'
			         }
			      }
			   },
			   plotOptions: {
			      series: {
			         shadow: true
			      },
			      candlestick: {
			         lineColor: '#404048'
			      },
			      map: {
			         shadow: false
			      }
			   },

			   // Highstock specific
			   navigator: {
			      xAxis: {
			         gridLineColor: '#D0D0D8'
			      }
			   },
			   rangeSelector: {
			      buttonTheme: {
			         fill: 'white',
			         stroke: '#C0C0C8',
			         'stroke-width': 1,
			         states: {
			            select: {
			               fill: '#D0D0D8'
			            }
			         }
			      }
			   },
			   scrollbar: {
			      trackBorderColor: '#C0C0C8'
			   },

			   // General
			   background2: '#E0E0E8'
			   
			};

			// Apply the theme
			Highcharts.setOptions(Highcharts.theme);
		});
	</script>
{% endblock %}